vardistExpandParam <-
function (vardist, params)
{
  # % VARDISTEXPANDPARAM Expand a parameter vector into a vardist structure.
  # % FORMAT
  # % DESC takes an VARDIST structure and a vector of parameters, and
  # % fills the structure with the given parameters. Also performs any
  # % necessary precomputation for likelihood and gradient
  # % computations, so can be computationally intensive to call.
  # % ARG model : the VARDIST structure to put the parameters in.
  # % ARG params : parameter vector containing the parameters to put in
  # % the VARDIST structure.
  # % 
  # % COPYRIGHT : Michalis K. Titsias, 2009
  # %
  # % COPYRIGHT : Neil D. Lawrence, 2009
  # %
  # % 
  # % SEEALSO : vardistCreate, vardistExtractParam, modelExpandParam
  # 
  # % VARGPLVM
  
  if (length(vardist$transforms)>0)
  {
    for (i in 1:length(vardist$transforms))
    {
      index <- vardist$transforms[[i]]$index
      fhandle <- paste(vardist$transforms[[i]]$type, "Transform", sep ="")
      # fhandle <- vardist$transforms[[i]]$type$func
      params[index] <- do.call(fhandle, list(params[index], "atox"))
    }
  }
  
  means <- params[1:(vardist$numData*vardist$latentDimension)];
  st <- vardist$numData*vardist$latentDimension + 1;
  covs <- params[st:length(params)];
  
  vardist$means <- matrix(means, vardist$numData, vardist$latentDimension);
  vardist$covars <- matrix(covs, vardist$numData, vardist$latentDimension);
  return (vardist)
}
